<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Immune cell infiltrates signature | Wellstone bilateral tibialis anterior FSHD biopsied muscle study</title>
<meta name="author" content="Chao-Jen Wong">
<meta name="description" content="Based on the longitudinal study, we have discovered that T cell proliferation, migration, and B cell-mediated immunity response are more prevalent in severely affected muscles, such as “IG-high”...">
<meta name="generator" content="bookdown 0.32 with bs4_book()">
<meta property="og:title" content="Chapter 9 Immune cell infiltrates signature | Wellstone bilateral tibialis anterior FSHD biopsied muscle study">
<meta property="og:type" content="book">
<meta property="og:url" content="https://fredHutch.github.io/Wellstone_BiLateral_Biopsy/immune-cell-infiltrates.html">
<meta property="og:image" content="https://fredHutch.github.io/Wellstone_BiLateral_Biopsy/images/cover.jpeg">
<meta property="og:description" content="Based on the longitudinal study, we have discovered that T cell proliferation, migration, and B cell-mediated immunity response are more prevalent in severely affected muscles, such as “IG-high”...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 9 Immune cell infiltrates signature | Wellstone bilateral tibialis anterior FSHD biopsied muscle study">
<meta name="twitter:description" content="Based on the longitudinal study, we have discovered that T cell proliferation, migration, and B cell-mediated immunity response are more prevalent in severely affected muscles, such as “IG-high”...">
<meta name="twitter:image" content="https://fredHutch.github.io/Wellstone_BiLateral_Biopsy/images/cover.jpeg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Sen-0.4.5/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=DM%20Mono&amp;display=swap" rel="stylesheet">
<link href="libs/Bitter-0.4.5/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Wellstone bilateral tibialis anterior FSHD biopsied muscle study</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> About</a></li>
<li><a class="" href="study-cohort.html"><span class="header-section-number">2</span> Study cohort</a></li>
<li><a class="" href="muscle-content.html"><span class="header-section-number">3</span> Transcript-based accessment for muscle content</a></li>
<li><a class="" href="mri-fat.html"><span class="header-section-number">4</span> MRI fat infiltration</a></li>
<li><a class="" href="MRI-vs-DUX4-score.html"><span class="header-section-number">5</span> MRI characteristics and DUX4 molecular signatures</a></li>
<li><a class="" href="DUX4-basket.html"><span class="header-section-number">6</span> DUX4 basket</a></li>
<li><a class="" href="other-baskets.html"><span class="header-section-number">7</span> Inflammatory, ECM, complement activation and immunoglobulins signatures</a></li>
<li><a class="" href="bilateral-comparison.html"><span class="header-section-number">8</span> Bilateral comparison</a></li>
<li><a class="active" href="immune-cell-infiltrates.html"><span class="header-section-number">9</span> Immune cell infiltrates signature</a></li>
<li><a class="" href="complement-scoring.html"><span class="header-section-number">10</span> Complement scoring</a></li>
<li><a class="" href="references.html">References</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="appendixA-buildTxDB.html"><span class="header-section-number">A</span> Build TxDB package from GTF</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/FredHutch/Wellstone_BiLateral_Biopsy">View book source <i class="fas fa-air-freshener"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="immune-cell-infiltrates" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Immune cell infiltrates signature<a class="anchor" aria-label="anchor" href="#immune-cell-infiltrates"><i class="fas fa-link"></i></a>
</h1>
<p>Based on the longitudinal study, we have discovered that T cell proliferation, migration, and B cell-mediated immunity response are more prevalent in severely affected muscles, such as “IG-high” and “High.” The objective of this chapter is as follows:</p>
<ol style="list-style-type: decimal">
<li>Identify the enriched GO terms (biological processes) directly linked to T/B cells and circulating immunoglobulins in the longitudinal study (High or IG0high vs. control).</li>
<li>Determine the differentially expressed genes (High vs. control) associated with the enriched GO terms (from step 1), and use heatmap visualization to observe the trend of an increase in gene expression across all longitudinal and bilateral samples, associated with the severity of FSHD (characterised by STIR status, fat fraction/infiltration percent) and/or complement scoring.</li>
<li>Identify immune cell markers that are differentially expressed (High vs. control) using the IRIS database (Abbs 2009) as a source.</li>
</ol>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mikelove/DESeq2">DESeq2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/writexl/">writexl</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/karthik/wesanderson">wesanderson</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">pkg_dir</span> <span class="op">&lt;-</span> <span class="st">"/Users/cwon2/CompBio/Wellstone_BiLateral_Biopsy"</span></span>
<span><span class="va">fig_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"figures"</span>, <span class="st">"immune-infiltration"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"data"</span>, <span class="st">"bilat_dds.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"data"</span>, <span class="st">"longitudinal_dds.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"data"</span>, <span class="st">"bilat_MLpredict.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"data"</span>, <span class="st">"comprehensive_df.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"scripts"</span>, <span class="st">"viz_tools.R"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tidy annotation from two datasets</span></span>
<span><span class="va">anno_gencode35</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">rowData</a></span><span class="op">(</span><span class="va">bilat_dds</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"gencode35_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># BiLat study using Gencode 36</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ens_id<span class="op">=</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">gencode35_id</span>, <span class="st">"\\..*"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">gene_name</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">anno_ens88</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">rowData</a></span><span class="op">(</span><span class="va">longitudinal_dds</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"ens88_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># longitudinal study ens v88</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ens_id<span class="op">=</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">gene_id</span>, <span class="st">"\\..*"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">gene_name</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ens88_id</span>, <span class="va">ens_id</span>, <span class="va">gene_name</span><span class="op">)</span></span>
<span><span class="co"># insert class to bilat_dds</span></span>
<span><span class="va">col_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">bilat_dds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">bilat_MLpredict</span>, by<span class="op">=</span><span class="st">"sample_id"</span><span class="op">)</span></span>
<span><span class="va">bilat_dds</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="va">col_data</span><span class="op">$</span><span class="va">class</span></span>
<span></span>
<span><span class="va">longitudinal_dds</span><span class="op">$</span><span class="va">STIR_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">longitudinal_dds</span><span class="op">$</span><span class="va">STIR_rating</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"STIR+"</span>, <span class="st">"STIR-"</span><span class="op">)</span></span>
<span>                                        </span></code></pre></div>
<div id="enriched-biological-processes-directly-associated-with-tb-cells" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Enriched biological processes directly associated with T/B cells<a class="anchor" aria-label="anchor" href="#enriched-biological-processes-directly-associated-with-tb-cells"><i class="fas fa-link"></i></a>
</h2>
<p>The code chunk below (1) obtains the enriched GO terms in more affected muscles from the longitudinal study, supplementary table 5, and (2) retains the enriched GO terms containing the terms including <code>T cell</code>, <code>B cell</code>, <code>humoral</code>, <code>immunoglobulin</code>, and <code>complement</code>. Total 20 terms are extracted.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">high_enriched</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"extdata"</span>, </span>
<span>    <span class="st">"suppl_table_5_Candidate_Biomarkers_and_Enriched_Go.xlsx"</span><span class="op">)</span>,</span>
<span>    sheet<span class="op">=</span><span class="fl">2</span>, skip<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ig_enriched</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"extdata"</span>, </span>
<span>    <span class="st">"suppl_table_5_Candidate_Biomarkers_and_Enriched_Go.xlsx"</span><span class="op">)</span>,</span>
<span>    sheet<span class="op">=</span><span class="fl">4</span>, skip<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">moderate_enriched</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"extdata"</span>, </span>
<span>    <span class="st">"suppl_table_5_Candidate_Biomarkers_and_Enriched_Go.xlsx"</span><span class="op">)</span>,</span>
<span>    sheet<span class="op">=</span><span class="fl">6</span>, skip<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the lymphocyte related GO ID</span></span>
<span><span class="va">infiltrates_go</span> <span class="op">&lt;-</span> <span class="va">high_enriched</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"T cell|B cell|humoral|immunoglobulin|complement"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">infiltrates_go</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">category</span>, <span class="va">over_represented_pvalue</span>, <span class="va">term</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>pvalue <span class="op">=</span> <span class="va">over_represented_pvalue</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pvalue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/format.html">format</a></span><span class="op">(</span><span class="va">pvalue</span>, scientific <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Enriched biological process GO terms (n=20)  related to T/B cells, humoral immune response, and immunoglobulin domains."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_paper</a></span><span class="op">(</span><span class="st">"hover"</span>, full_width <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class=" lightable-paper lightable-hover" style='font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>
<span id="tab:sup-table-5">Table 9.1: </span>Enriched biological process GO terms (n=20) related to T/B cells, humoral immune response, and immunoglobulin domains.
</caption>
<thead><tr>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
pvalue
</th>
<th style="text-align:left;">
term
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
<a href="GO:0002455" class="uri">GO:0002455</a>
</td>
<td style="text-align:left;">
4.391414e-10
</td>
<td style="text-align:left;">
humoral immune response mediated by circulating immunoglobulin
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0002460" class="uri">GO:0002460</a>
</td>
<td style="text-align:left;">
6.665762e-09
</td>
<td style="text-align:left;">
adaptive immune response based on somatic recombination of immune receptors built from immunoglobulin superfamily domains
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0002920" class="uri">GO:0002920</a>
</td>
<td style="text-align:left;">
2.865839e-11
</td>
<td style="text-align:left;">
regulation of humoral immune response
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0006956" class="uri">GO:0006956</a>
</td>
<td style="text-align:left;">
4.086619e-10
</td>
<td style="text-align:left;">
complement activation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0006957" class="uri">GO:0006957</a>
</td>
<td style="text-align:left;">
1.965806e-04
</td>
<td style="text-align:left;">
complement activation, alternative pathway
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0006958" class="uri">GO:0006958</a>
</td>
<td style="text-align:left;">
1.619492e-10
</td>
<td style="text-align:left;">
complement activation, classical pathway
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0006959" class="uri">GO:0006959</a>
</td>
<td style="text-align:left;">
1.158839e-15
</td>
<td style="text-align:left;">
humoral immune response
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0010818" class="uri">GO:0010818</a>
</td>
<td style="text-align:left;">
2.450256e-09
</td>
<td style="text-align:left;">
T cell chemotaxis
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0016064" class="uri">GO:0016064</a>
</td>
<td style="text-align:left;">
1.175922e-08
</td>
<td style="text-align:left;">
immunoglobulin mediated immune response
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0019724" class="uri">GO:0019724</a>
</td>
<td style="text-align:left;">
1.380039e-08
</td>
<td style="text-align:left;">
B cell mediated immunity
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0030449" class="uri">GO:0030449</a>
</td>
<td style="text-align:left;">
7.071256e-11
</td>
<td style="text-align:left;">
regulation of complement activation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0031295" class="uri">GO:0031295</a>
</td>
<td style="text-align:left;">
1.531739e-04
</td>
<td style="text-align:left;">
T cell costimulation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0042098" class="uri">GO:0042098</a>
</td>
<td style="text-align:left;">
5.735434e-06
</td>
<td style="text-align:left;">
T cell proliferation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0042102" class="uri">GO:0042102</a>
</td>
<td style="text-align:left;">
4.877625e-05
</td>
<td style="text-align:left;">
positive regulation of T cell proliferation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0042110" class="uri">GO:0042110</a>
</td>
<td style="text-align:left;">
6.083250e-07
</td>
<td style="text-align:left;">
T cell activation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0042129" class="uri">GO:0042129</a>
</td>
<td style="text-align:left;">
1.273162e-05
</td>
<td style="text-align:left;">
regulation of T cell proliferation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0050863" class="uri">GO:0050863</a>
</td>
<td style="text-align:left;">
3.541698e-08
</td>
<td style="text-align:left;">
regulation of T cell activation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0050870" class="uri">GO:0050870</a>
</td>
<td style="text-align:left;">
1.090819e-06
</td>
<td style="text-align:left;">
positive regulation of T cell activation
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:0072678" class="uri">GO:0072678</a>
</td>
<td style="text-align:left;">
1.727781e-11
</td>
<td style="text-align:left;">
T cell migration
</td>
</tr>
<tr>
<td style="text-align:left;">
<a href="GO:2000404" class="uri">GO:2000404</a>
</td>
<td style="text-align:left;">
1.335915e-05
</td>
<td style="text-align:left;">
regulation of T cell migration
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span></span>
<span><span class="co">#lymphocyte_go &lt;- high_enriched %&gt;%</span></span>
<span><span class="co">#   dplyr::filter(str_detect(term, "lymphocyte"))</span></span></code></pre></div>
<p>Display the p-values yielded by GSEA:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">infiltrates_go</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">category</span>, <span class="va">term</span>, <span class="va">over_represented_pvalue</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ig_enriched</span>, <span class="va">category</span>, <span class="va">over_represented_pvalue</span><span class="op">)</span>,</span>
<span>            by<span class="op">=</span><span class="st">"category"</span>, suffix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">".High"</span>, <span class="st">".IG-High"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span>key<span class="op">=</span><span class="va">class</span>, value<span class="op">=</span><span class="va">pvalue</span>, <span class="op">-</span><span class="va">category</span>, <span class="op">-</span><span class="va">term</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>class <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">class</span>, </span>
<span>                                    <span class="st">"over_represented_pvalue."</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>                term <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trunc.html">str_trunc</a></span><span class="op">(</span><span class="va">term</span>, <span class="fl">45</span><span class="op">)</span>,</span>
<span>                class <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">class</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IG-High"</span>, <span class="st">"High"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>log10pvalue <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">pvalue</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">cat_levels</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"High"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">term</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>term<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">term</span>, levels<span class="op">=</span><span class="va">cat_levels</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co">#dplyr::mutate(term = factor(term,levels=cat_levels)) %&gt;%</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">class</span>, y<span class="op">=</span><span class="va">term</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">log10pvalue</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red1"</span>, alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span>               show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Enriched GO terms related to T/B cells and immunoglobulins"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">1</span>, size<span class="op">=</span><span class="fl">9.5</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 11 rows containing missing values</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:infiltrates-go-p-values"></span>
<img src="08-immune-cell-infiltrates-signature_files/figure-html/infiltrates-go-p-values-1.png" alt="Enriched GO terms related to T and B cells and immunoglobulin domains. Red dots present the p-value of enriched GO terms in IG or High samples." width="672"><p class="caption">
Figure 9.1: Enriched GO terms related to T and B cells and immunoglobulin domains. Red dots present the p-value of enriched GO terms in IG or High samples.
</p>
</div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">fig_dir</span>, <span class="st">"longitudinal-enriched-immunity-GO.pdf"</span><span class="op">)</span>, </span>
<span>       width<span class="op">=</span><span class="fl">3.8</span>, height<span class="op">=</span><span class="fl">4.2</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Warning: Removed 11 rows containing missing values</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre></div>
</div>
<div id="significant-genes-associated-with-the-tb-associated-enriched-go-terms" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Significant genes associated with the T/B-associated enriched GO terms<a class="anchor" aria-label="anchor" href="#significant-genes-associated-with-the-tb-associated-enriched-go-terms"><i class="fas fa-link"></i></a>
</h2>
<p>The code chunk below aim to identify significantly expressed genes in High or IG-High (vs. contls) that are involved in the enriched GO terms obtained previously.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">high_sig</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"extdata"</span>, </span>
<span>    <span class="st">"suppl_table_5_Candidate_Biomarkers_and_Enriched_Go.xlsx"</span><span class="op">)</span>,</span>
<span>    sheet<span class="op">=</span><span class="fl">1</span>, skip<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gene_name</span>, <span class="va">gencode_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ens_id <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">gencode_id</span>, <span class="st">"\\..*"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ig_sig</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"extdata"</span>, </span>
<span>    <span class="st">"suppl_table_5_Candidate_Biomarkers_and_Enriched_Go.xlsx"</span><span class="op">)</span>,</span>
<span>    sheet<span class="op">=</span><span class="fl">3</span>, skip<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gene_name</span>, <span class="va">gencode_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ens_id <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">gencode_id</span>, <span class="st">"\\..*"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">high_sig</span>, <span class="va">ig_sig</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">gene_name</span>, .keep_all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## keep the genes that involved in the infiltrates_go</span></span>
<span><span class="va">gene2cat</span> <span class="op">&lt;-</span> <span class="fu">goseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/goseq/man/getgo.html">getgo</a></span><span class="op">(</span><span class="va">sig</span><span class="op">$</span><span class="va">ens_id</span>, <span class="st">"hg38"</span>, <span class="st">"ensGene"</span>, fetch.cats <span class="op">=</span> <span class="st">"GO:BP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gene2cat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sig</span><span class="op">$</span><span class="va">ens_id</span></span>
<span><span class="va">cat2gene</span> <span class="op">&lt;-</span> <span class="fu">goseq</span><span class="fu">:::</span><span class="fu">reversemapping</span><span class="op">(</span><span class="va">gene2cat</span><span class="op">)</span><span class="op">[</span><span class="va">infiltrates_go</span><span class="op">$</span><span class="va">category</span><span class="op">]</span></span>
<span><span class="va">infiltrates_act</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">cat2gene</span>, <span class="kw">function</span><span class="op">(</span><span class="va">cat_gene</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sig</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ens_id</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html">%in%</a></span> <span class="va">cat_gene</span><span class="op">)</span></span>
<span><span class="op">}</span>, .id<span class="op">=</span><span class="st">"category"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">infiltrates_go</span>, <span class="va">category</span>, <span class="va">term</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"category"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>GOID <span class="op">=</span> <span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">gene_name</span>, .keep_all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>gene_id <span class="op">=</span> <span class="va">gencode_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co">#arrange(gene_name) %&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"T cell"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"T cell migration / activation"</span>,</span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"humoral|complement"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"B cell mediated / humoral immune response"</span>,</span>
<span>    <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">term</span>, <span class="st">"adaptive"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"adaptive immune response (IG domains)"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">category</span>, <span class="va">gene_name</span><span class="op">)</span></span></code></pre></div>
<p>Total 95 B/T cell immunity response significant markers are identified.</p>
<div id="heatmap-longitudinal-study" class="section level3" number="9.2.1">
<h3>
<span class="header-section-number">9.2.1</span> Heatmap: Longitudinal study<a class="anchor" aria-label="anchor" href="#heatmap-longitudinal-study"><i class="fas fa-link"></i></a>
</h3>
<p>Now we visualized the trend of the increased expression levels on the longitidunal samples, arranges by ML-defined classes: Control, Mild, Moderate, IG-High, High, and Muscle-low.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Control<span class="op">=</span><span class="st">"#ff7f00"</span>, </span>
<span>                    Mild<span class="op">=</span><span class="st">"#a65628"</span>, </span>
<span>                    Moderate<span class="op">=</span><span class="st">"#f781bf"</span>, </span>
<span>                    `IG-High`<span class="op">=</span><span class="st">"#984ea3"</span>, High<span class="op">=</span><span class="st">"#e41a1c"</span>, </span>
<span>                   `Muscle-Low`<span class="op">=</span><span class="st">"#377eb8"</span><span class="op">)</span></span>
<span><span class="va">category_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"Darjeeling2"</span>, n<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">category_color</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">infiltrates_act</span><span class="op">$</span><span class="va">category</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ann_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="va">cluster_color</span>, category <span class="op">=</span> <span class="va">category_color</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># include column annotaion: class, fat fraction, STIR rating, and histophatology</span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#f7f7f7"</span>, <span class="st">"#238b45"</span><span class="op">)</span></span>
<span><span class="va">annotation_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">longitudinal_dds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cluster</span>, <span class="va">fat_fraction</span>, <span class="va">STIR_status</span>, </span>
<span>                <span class="co">#STIR_rating,</span></span>
<span>                <span class="va">Pathology.Score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>class<span class="op">=</span><span class="va">cluster</span>, `fat fraction`<span class="op">=</span><span class="va">fat_fraction</span>,</span>
<span>                `STIR+/-` <span class="op">=</span> <span class="va">STIR_status</span>,</span>
<span>                `histopathology` <span class="op">=</span> <span class="va">Pathology.Score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`STIR+/-` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">`STIR+/-`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ann_cor</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="va">cluster_color</span>, category <span class="op">=</span> <span class="va">category_color</span>,</span>
<span>                 `fat fraction` <span class="op">=</span> <span class="va">col</span>, `STIR+/-` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`STIR-`<span class="op">=</span><span class="st">"#f7f7f7"</span>,</span>
<span>                                                     `STIR+`<span class="op">=</span><span class="st">"#238b45"</span><span class="op">)</span>,</span>
<span>                 `histopathology` <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span>
<span><span class="fu">markers_heatmp_group_by_types_class</span><span class="op">(</span>markers <span class="op">=</span> <span class="va">infiltrates_act</span>, </span>
<span>                                    dds <span class="op">=</span> <span class="va">longitudinal_dds</span>, </span>
<span>                                    factor <span class="op">=</span> <span class="st">"cluster"</span>, </span>
<span>                                    annotation_col <span class="op">=</span> <span class="va">annotation_col</span>,</span>
<span>                                    ann_cor <span class="op">=</span> <span class="va">ann_cor</span>, </span>
<span>                                    annotation_legend<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:heatmap-immune-infiltrate-longi"></span>
<img src="08-immune-cell-infiltrates-signature_files/figure-html/heatmap-immune-infiltrate-longi-1.png" alt="Heatmap demonstrating the increased expression trend on more affected muscle. Color presented the row-wised z-score of expression levels." width="768"><p class="caption">
Figure 9.2: Heatmap demonstrating the increased expression trend on more affected muscle. Color presented the row-wised z-score of expression levels.
</p>
</div>
</div>
<div id="heatmap-bilateral-study" class="section level3" number="9.2.2">
<h3>
<span class="header-section-number">9.2.2</span> Heatmap: bilateral study<a class="anchor" aria-label="anchor" href="#heatmap-bilateral-study"><i class="fas fa-link"></i></a>
</h3>
<p>Heatmap of the expression levels of 95 genes on the bilateral samples.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotation_col</span> <span class="op">&lt;-</span> <span class="va">comprehensive_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">class</span>, <span class="va">Fat_Infilt_Percent</span>, <span class="va">STIR_status</span>,</span>
<span>                <span class="va">`Cumulative Score`</span>, <span class="va">`Complement Scoring`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>`fat percent` <span class="op">=</span> <span class="va">Fat_Infilt_Percent</span>, </span>
<span>                `STIR+/-` <span class="op">=</span> <span class="va">STIR_status</span>,</span>
<span>                `histopathology` <span class="op">=</span> <span class="va">`Cumulative Score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"sample_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`Control-like`<span class="op">=</span><span class="st">"#a65628"</span>, </span>
<span>                    `Moderate+`<span class="op">=</span><span class="st">"#984ea3"</span>, </span>
<span>                    `Muscle-Low`<span class="op">=</span><span class="st">"#377eb8"</span><span class="op">)</span></span>
<span><span class="va">ann_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_color</span>, category <span class="op">=</span> <span class="va">category_color</span>,</span>
<span>                `fat percent` <span class="op">=</span> <span class="va">col</span>, </span>
<span>                `STIR+/-` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`STIR-`<span class="op">=</span><span class="st">"#f7f7f7"</span>, `STIR+`<span class="op">=</span><span class="st">"#238b45"</span><span class="op">)</span>,</span>
<span>                `histopathology` <span class="op">=</span> <span class="va">col</span>, </span>
<span>                `Complement Scoring` <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span>
<span></span>
<span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="va">infiltrates_act</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">anno_gencode35</span>, <span class="va">ens_id</span>, <span class="va">gencode35_id</span><span class="op">)</span>,</span>
<span>            by<span class="op">=</span><span class="st">"ens_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">gene_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>gene_id <span class="op">=</span> <span class="va">gencode35_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">gene_id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">markers_heatmp_group_by_types_class</span><span class="op">(</span>markers <span class="op">=</span> <span class="va">markers</span>, </span>
<span>                                    dds <span class="op">=</span> <span class="va">bilat_dds</span>, </span>
<span>                                    factor <span class="op">=</span> <span class="st">"class"</span>, </span>
<span>                                    annotation_legend<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                                    annotation_col <span class="op">=</span> <span class="va">annotation_col</span>,</span>
<span>                                    ann_cor <span class="op">=</span> <span class="va">ann_cor</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="08-immune-cell-infiltrates-signature_files/figure-html/heatmap-immune-infiltrate-bilat-1.png" width="768"></div>
</div>
</div>
<div id="immune-cell-infiltrate-signature" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Immune cell infiltrate signature<a class="anchor" aria-label="anchor" href="#immune-cell-infiltrate-signature"><i class="fas fa-link"></i></a>
</h2>
<p>Using a generic cell-type marker dataset from the immune response in silico (IRIS) (Abbas 2009), we detected 63 immune cell markers whose expression levels are signficiantly elevated in more affected muscles. With additonal significant immunity-related markers, including such as cytokine receptors in B cells (IL-4R, IL-21R), STAT6, Leukocyte immunoglobulin-like receptor B family (LILRB4, LILRB5), T cell surface antigens (CD2 and CD4), T and B cell interaction and migration (CCL19), and STAT6, we demonstrated a immune cell infiltrate signatures in both longitudinal and bilateral samples.</p>
<p>Code chunk below identified 63 immune cell markers as a subset of the IRIS database (Abbas 2009).</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PLIER</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">bloodCellMarkersIRISDMAP</span><span class="op">)</span></span>
<span><span class="co"># about 860 markers</span></span>
<span><span class="va">blood_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">bloodCellMarkersIRISDMAP</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"gene_name"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gene_name</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"IRIS"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># 63 are DE in High</span></span>
<span><span class="va">sig_blood_iris</span> <span class="op">&lt;-</span> <span class="va">high_sig</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">blood_iris</span>, by<span class="op">=</span><span class="st">"gene_name"</span><span class="op">)</span> </span>
<span><span class="va">category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sig_blood_iris</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sig_blood_iris</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">sig_blood_iris</span><span class="op">$</span><span class="va">category</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">sig_blood_iris</span><span class="op">[</span>, <span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sig_blood_iris</span><span class="op">)</span><span class="op">]</span>, <span class="fl">1</span>, </span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.vector.html">as.vector</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">category</span><span class="op">[</span><span class="va">tmp</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>       <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_blood_iris</span>  <span class="op">&lt;-</span> <span class="va">sig_blood_iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">gene_name</span>, <span class="va">gencode_id</span>, <span class="va">ens_id</span>, <span class="va">category</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>gene_id <span class="op">=</span> <span class="va">gencode_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">category</span>, <span class="st">"IRIS_"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">category</span>, <span class="st">"\\-.*"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">category</span>, <span class="va">gene_name</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># add others: IL-4R, IL-21R, LILRB4, LILRB5, CD2, CD4, CCL19</span></span>
<span><span class="va">others</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>gene_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IL4R"</span>, <span class="st">"IL21R"</span>, <span class="st">"LILRB4"</span>,</span>
<span>                                   <span class="st">"LILRB5"</span>,</span>
<span>                                   <span class="st">"CD2"</span>, <span class="st">"CD4"</span>, <span class="st">"CCL19"</span>, <span class="st">"STAT6"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">anno_ens88</span>, by<span class="op">=</span><span class="st">"gene_name"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>gene_id <span class="op">=</span> <span class="va">ens88_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>category<span class="op">=</span><span class="st">"Others"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">gene_name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_blood_iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">sig_blood_iris</span>, <span class="va">others</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">category</span>, </span>
<span>                                  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bcell"</span>, <span class="st">"CD4Tcell"</span>, <span class="st">"CD8Tcell"</span>,</span>
<span>                                             <span class="st">"DendriticCell"</span>,</span>
<span>                                             <span class="st">"Monocyte"</span>, <span class="st">"Neutrophil"</span>,</span>
<span>                                             <span class="st">"NKcell"</span>, <span class="st">"PlasmaCell"</span>,</span>
<span>                                             <span class="st">"Others"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="viz-the-immune-cell-infiltrate-siganiture-from-the-longitudinal-study" class="section level3" number="9.3.1">
<h3>
<span class="header-section-number">9.3.1</span> Viz the immune cell infiltrate siganiture from the longitudinal study<a class="anchor" aria-label="anchor" href="#viz-the-immune-cell-infiltrate-siganiture-from-the-longitudinal-study"><i class="fas fa-link"></i></a>
</h3>
<p>The following heatmap illustrates that there is a tendency of higher expression levels in muscles that are more affected.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>Control<span class="op">=</span><span class="st">"#ff7f00"</span>, </span>
<span>                    Mild<span class="op">=</span><span class="st">"#a65628"</span>, </span>
<span>                    Moderate<span class="op">=</span><span class="st">"#f781bf"</span>, </span>
<span>                    `IG-High`<span class="op">=</span><span class="st">"#984ea3"</span>, High<span class="op">=</span><span class="st">"#e41a1c"</span>, </span>
<span>                   `Muscle-Low`<span class="op">=</span><span class="st">"#377eb8"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#f7f7f7"</span>, <span class="st">"#238b45"</span><span class="op">)</span></span>
<span><span class="va">annotation_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">longitudinal_dds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cluster</span>, <span class="va">fat_fraction</span>, <span class="va">STIR_status</span>, </span>
<span>                <span class="co">#STIR_rating,</span></span>
<span>                <span class="va">Pathology.Score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>class<span class="op">=</span><span class="va">cluster</span>, `fat fraction`<span class="op">=</span><span class="va">fat_fraction</span>,</span>
<span>                `STIR+/-` <span class="op">=</span> <span class="va">STIR_status</span>,</span>
<span>                `histopathology` <span class="op">=</span> <span class="va">Pathology.Score</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`STIR+/-` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">`STIR+/-`</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">category_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/wesanderson/man/wes_palette.html">wes_palette</a></span><span class="op">(</span><span class="st">"Darjeeling1"</span>, n<span class="op">=</span><span class="fl">9</span>, typ<span class="op">=</span><span class="st">"continuous"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">category_color</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html">levels</a></span><span class="op">(</span><span class="va">sig_blood_iris</span><span class="op">$</span><span class="va">category</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ann_cor</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="va">cluster_color</span>, category <span class="op">=</span> <span class="va">category_color</span>,</span>
<span>                 `fat fraction` <span class="op">=</span> <span class="va">col</span>, `STIR+/-` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`STIR-`<span class="op">=</span><span class="st">"#f7f7f7"</span>,</span>
<span>                                                     `STIR+`<span class="op">=</span><span class="st">"#238b45"</span><span class="op">)</span>,</span>
<span>                 `histopathology` <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span>
<span><span class="fu">markers_heatmp_group_by_types_class</span><span class="op">(</span>markers <span class="op">=</span> <span class="va">sig_blood_iris</span>, </span>
<span>                                    dds <span class="op">=</span> <span class="va">longitudinal_dds</span>, </span>
<span>                                    factor <span class="op">=</span> <span class="st">"cluster"</span>, </span>
<span>                                    annotation_col <span class="op">=</span> <span class="va">annotation_col</span>,</span>
<span>                                    ann_cor <span class="op">=</span> <span class="va">ann_cor</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:longitudinal-63-sig-immune-cell-markers-heatmap"></span>
<img src="08-immune-cell-infiltrates-signature_files/figure-html/longitudinal-63-sig-immune-cell-markers-heatmap-1.png" alt="Heapmap demonstrating the expression levels (by row-wise z-score of log10(TPM++1) in the longitudinal study." width="672"><p class="caption">
Figure 9.3: Heapmap demonstrating the expression levels (by row-wise z-score of log10(TPM++1) in the longitudinal study.
</p>
</div>
</div>
<div id="bilateral-study" class="section level3" number="9.3.2">
<h3>
<span class="header-section-number">9.3.2</span> Bilateral study<a class="anchor" aria-label="anchor" href="#bilateral-study"><i class="fas fa-link"></i></a>
</h3>
<p>The heatmap for the bilateral study below incorporates the complement scoring.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">annotation_col</span> <span class="op">&lt;-</span> <span class="va">comprehensive_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">class</span>, <span class="va">Fat_Infilt_Percent</span>, <span class="va">STIR_status</span>,</span>
<span>                <span class="va">`Cumulative Score`</span>, <span class="va">`Complement Scoring`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>`fat percent` <span class="op">=</span> <span class="va">Fat_Infilt_Percent</span>, </span>
<span>                `STIR+/-` <span class="op">=</span> <span class="va">STIR_status</span>,</span>
<span>                `histopathology` <span class="op">=</span> <span class="va">`Cumulative Score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"sample_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`Control-like`<span class="op">=</span><span class="st">"#a65628"</span>, </span>
<span>                    `Moderate+`<span class="op">=</span><span class="st">"#984ea3"</span>, </span>
<span>                    `Muscle-Low`<span class="op">=</span><span class="st">"#377eb8"</span><span class="op">)</span></span>
<span><span class="va">ann_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>class <span class="op">=</span> <span class="va">class_color</span>, category <span class="op">=</span> <span class="va">category_color</span>,</span>
<span>                `fat percent` <span class="op">=</span> <span class="va">col</span>, </span>
<span>                `STIR+/-` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`STIR-`<span class="op">=</span><span class="st">"#f7f7f7"</span>, `STIR+`<span class="op">=</span><span class="st">"#238b45"</span><span class="op">)</span>,</span>
<span>                `histopathology` <span class="op">=</span> <span class="va">col</span>, </span>
<span>                `Complement Scoring` <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># update sig_blood_iris gene_id to gencode35_id</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">sig_blood_iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">anno_gencode35</span>, <span class="va">ens_id</span>, <span class="va">gencode35_id</span><span class="op">)</span>, </span>
<span>            by<span class="op">=</span><span class="st">"ens_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">gene_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>gene_id <span class="op">=</span> <span class="va">gencode35_id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">markers_heatmp_group_by_types_class</span><span class="op">(</span>markers <span class="op">=</span> <span class="va">tmp</span>,</span>
<span>                                    dds <span class="op">=</span> <span class="va">bilat_dds</span>, </span>
<span>                                    factor <span class="op">=</span> <span class="st">"class"</span>, </span>
<span>                                    annotation_col <span class="op">=</span> <span class="va">annotation_col</span>,</span>
<span>                                    ann_cor <span class="op">=</span> <span class="va">ann_cor</span> <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="08-immune-cell-infiltrates-signature_files/figure-html/bilat-63-sig-immune-cell-markers-heatmap-1.png" width="672"></div>
</div>
</div>
<div id="complement-scoring-vs.-immune-cell-infiltrates-signature" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Complement scoring vs. immune cell infiltrates signature<a class="anchor" aria-label="anchor" href="#complement-scoring-vs.-immune-cell-infiltrates-signature"><i class="fas fa-link"></i></a>
</h2>
<p>The 63 immune cell markers mentioned earlier characterize the signature of immune cell infiltration. The heatmap presented in Fig. <a href="#fig:bilat-63-sig-immune-cell-markers-heatmap"><strong>??</strong></a> shows that the elevated expression levels of these markers are in line with the complement scoring. The following code chunk computes the Spearman correlation coefficient, which is equal to 0.456.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">bilat_dds</span><span class="op">[</span><span class="va">tmp</span><span class="op">$</span><span class="va">gene_id</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"TPM"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">signature</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/colSums.html">colMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">tpm</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"sample_id"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">signature</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"avg_z_score"</span></span>
<span></span>
<span><span class="va">tmp_df</span> <span class="op">&lt;-</span> <span class="va">comprehensive_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">`Complement Scoring`</span>, <span class="va">`STIR_status`</span>,</span>
<span>                <span class="va">`STIR_RATING`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">signature</span>, by<span class="op">=</span><span class="st">"sample_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">`Complement Scoring`</span>, <span class="va">`avg_z_score`</span><span class="op">)</span> </span>
<span>  </span>
<span><span class="va">tmp_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">`Complement Scoring`</span>, <span class="va">`avg_z_score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">`Complement Scoring`</span>, <span class="va">`avg_z_score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">corrr</span><span class="fu">::</span><span class="fu"><a href="https://corrr.tidymodels.org/reference/correlate.html">correlate</a></span><span class="op">(</span><span class="va">.</span>, method<span class="op">=</span><span class="st">"spearman"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   term               `Complement Scoring` avg_z_score</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                             &lt;dbl&gt;       &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 Complement Scoring               NA           0.456</span></span>
<span><span class="co">#&gt; 2 avg_z_score                       0.456      NA</span></span>
<span>  </span>
<span><span class="va">tmp_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">`Complement Scoring`</span>, <span class="va">`avg_z_score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>`Complement Scoring`<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">`Complement Scoring`</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">`Complement Scoring`</span>, y<span class="op">=</span><span class="va">avg_z_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">`Complement Scoring`</span><span class="op">)</span>,</span>
<span>                 binaxis<span class="op">=</span><span class="st">'y'</span>, stackdir<span class="op">=</span><span class="st">'center'</span>,</span>
<span>                 show.legend <span class="op">=</span> <span class="cn">FALSE</span>, alpha<span class="op">=</span><span class="fl">0.8</span>,</span>
<span>                 stackratio<span class="op">=</span><span class="fl">1.5</span>, dotsize<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:63-blood-markers-correlated-with-complement-scoring"></span>
<img src="08-immune-cell-infiltrates-signature_files/figure-html/63-blood-markers-correlated-with-complement-scoring-1.png" alt="Dotplot of immune cell infiltrates signature (presented by average z-score) groups by complement scoring 1, 2, and 3." width="672"><p class="caption">
Figure 9.4: Dotplot of immune cell infiltrates signature (presented by average z-score) groups by complement scoring 1, 2, and 3.
</p>
</div>
</div>
<div id="stir-status-vs.-immune-cell-infiltrates-signature" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> STIR status vs. immune cell infiltrates signature<a class="anchor" aria-label="anchor" href="#stir-status-vs.-immune-cell-infiltrates-signature"><i class="fas fa-link"></i></a>
</h2>
<p>The heatmap <a href="#fig:bilat-63-sig-immune-cell-markers-heatmap"><strong>??</strong></a> also suggested that elevated immune cell signatures is associated with with STIR status: wilcox test p-value = <span class="math inline">\(3e-6\)</span>.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">`STIR_status`</span>, <span class="va">`avg_z_score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">`STIR_status`</span>, y<span class="op">=</span><span class="va">avg_z_score</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.5</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">`STIR_status`</span><span class="op">)</span>,</span>
<span>                 binaxis<span class="op">=</span><span class="st">'y'</span>, stackdir<span class="op">=</span><span class="st">'center'</span>,</span>
<span>                 show.legend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 stackratio<span class="op">=</span><span class="fl">1.5</span>, dotsize<span class="op">=</span><span class="fl">1.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="08-immune-cell-infiltrates-signature_files/figure-html/STIR-vs-immune-cell-infilrates-signatures-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">tmp_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">`STIR_status`</span>, <span class="va">`avg_z_score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">`STIR_status`</span>, <span class="va">`avg_z_score`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span>key<span class="op">=</span><span class="va">STIR_status</span>, value<span class="op">=</span><span class="va">avg_z_score</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">`STIR-`</span>, <span class="va">x</span><span class="op">$</span><span class="va">`STIR+`</span> <span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum exact test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  x$`STIR-` and x$`STIR+`</span></span>
<span><span class="co">#&gt; W = 135, p-value = 3.177e-06</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
</div>
<div id="bilateral-comparison-analysis-for-the-immune-cell-infiltrate-markers" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Bilateral comparison analysis for the immune cell infiltrate markers<a class="anchor" aria-label="anchor" href="#bilateral-comparison-analysis-for-the-immune-cell-infiltrate-markers"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>write a supplementary table listing <code>sig_blood_iris</code> and <code>infiltrates_act</code>
</li>
<li>bilateral comparison analysis for <code>sig_blood_iris</code> and <code>infiltrates_act</code>: check the gitbook chap 7: how did I do it?</li>
</ol>
<ul>
<li>input: data frame with columns gene_id, gene_names, Left and right</li>
<li>output: correlation coefficient table</li>
</ul>
<div id="significant-immune-cell-markers" class="section level3" number="9.6.1">
<h3>
<span class="header-section-number">9.6.1</span> 63 significant immune cell markers<a class="anchor" aria-label="anchor" href="#significant-immune-cell-markers"><i class="fas fa-link"></i></a>
</h3>
<p>In the previous section, we identified a signature of immune cell infiltrates characterized by 63 immune cell markers in the longitudinal study. Here we compute their expression correlation between left and right muscles in the bilateral study.</p>
<p>The code below shows the tools to compute the correlation between L and R muscles on the immune cell infiltrate markers.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">col_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">colData</a></span><span class="op">(</span><span class="va">bilat_dds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># convert gene_id to Gencode35</span></span>
<span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="va">sig_blood_iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">anno_gencode35</span>, <span class="va">ens_id</span>, <span class="va">gencode35_id</span><span class="op">)</span>, </span>
<span>            by<span class="op">=</span><span class="st">"ens_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">gene_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>gene_id <span class="op">=</span> <span class="va">gencode35_id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">.markers_bilateral_correlation</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">markers</span>, <span class="va">dds</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tpm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">dds</span><span class="op">[</span><span class="va">markers</span><span class="op">$</span><span class="va">gene_id</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"TPM"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/t.html">t</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"sample_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span><span class="op">(</span>key<span class="op">=</span><span class="va">gene_id</span>, value<span class="op">=</span><span class="va">TPM</span>, <span class="op">-</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">col_data</span>, <span class="va">sample_id</span>, <span class="va">location</span>,</span>
<span>                              <span class="va">Subject</span><span class="op">)</span>, by<span class="op">=</span><span class="st">"sample_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">sample_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span>key<span class="op">=</span><span class="va">location</span>, value<span class="op">=</span><span class="va">TPM</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">L</span>, <span class="va">R</span><span class="op">)</span> </span>
<span>  <span class="va">gene_cor</span> <span class="op">&lt;-</span> <span class="va">tpm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>L_log <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">L</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, R_log<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op">(</span><span class="va">R</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gene_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Pearson_by_TPM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">L</span>, <span class="va">R</span><span class="op">)</span>, </span>
<span>              Pearson_by_log10TPM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">L_log</span>, <span class="va">R_log</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">markers</span>, by<span class="op">=</span><span class="st">"gene_id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Pearson_by_log10TPM</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">gene_name</span>, .after<span class="op">=</span><span class="va">gene_id</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gene_cor</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">.avg_TPM_by_class</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">markers</span>, <span class="va">dds</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="va">avg_TPM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html">levels</a></span><span class="op">(</span><span class="va">dds</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html">assays</a></span><span class="op">(</span><span class="va">dds</span><span class="op">[</span><span class="va">markers</span><span class="op">$</span><span class="va">gene_id</span><span class="op">]</span><span class="op">)</span><span class="op">[[</span><span class="st">"TPM"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="va">dds</span><span class="op">$</span><span class="va">class</span> <span class="op">==</span> <span class="va">x</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>       <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/colSums.html">rowMeans</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> </span>
<span>   <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>     <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html">add_column</a></span><span class="op">(</span>gene_id <span class="op">=</span> <span class="va">markers</span><span class="op">$</span><span class="va">gene_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename_with</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Factor-class.html">levels</a></span><span class="op">(</span><span class="va">dds</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>, <span class="st">" avg TPM"</span><span class="op">)</span>, </span>
<span>                        <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"..."</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Display the correlation and average TPM grouped by ML-based classes.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_cor_63</span> <span class="op">&lt;-</span> <span class="fu">.markers_bilateral_correlation</span><span class="op">(</span>markers<span class="op">=</span><span class="va">markers</span>,</span>
<span>                                           dds<span class="op">=</span><span class="va">bilat_dds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">.avg_TPM_by_class</span><span class="op">(</span>markers <span class="op">=</span> <span class="va">markers</span>, dds<span class="op">=</span><span class="va">bilat_dds</span><span class="op">)</span>, </span>
<span>                   by<span class="op">=</span><span class="st">"gene_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_cor_63</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Pearson_by_TPM</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Sixty-three significant immune cell markers correlation analysis between left and right biopsied muscles. The Peason correlation coefficients are compuated using the expression levels presented by Log10(TPM+1)."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:display-63-sig-immune-cell-tpm">Table 9.2: </span>Sixty-three significant immune cell markers correlation analysis between left and right biopsied muscles. The Peason correlation coefficients are compuated using the expression levels presented by Log10(TPM+1).
</caption>
<thead><tr>
<th style="text-align:left;">
gene_id
</th>
<th style="text-align:left;">
gene_name
</th>
<th style="text-align:right;">
Pearson_by_log10TPM
</th>
<th style="text-align:left;">
ens_id
</th>
<th style="text-align:left;">
category
</th>
<th style="text-align:right;">
Control-like avg TPM
</th>
<th style="text-align:right;">
Moderate+ avg TPM
</th>
<th style="text-align:right;">
Muscle-Low avg TPM
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000038945.15
</td>
<td style="text-align:left;">
MSR1
</td>
<td style="text-align:right;">
0.8538713
</td>
<td style="text-align:left;">
ENSG00000038945
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1165807
</td>
<td style="text-align:right;">
0.5913336
</td>
<td style="text-align:right;">
0.8065051
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000124772.12
</td>
<td style="text-align:left;">
CPNE5
</td>
<td style="text-align:right;">
0.8373333
</td>
<td style="text-align:left;">
ENSG00000124772
</td>
<td style="text-align:left;">
Bcell
</td>
<td style="text-align:right;">
0.0443273
</td>
<td style="text-align:right;">
0.3835624
</td>
<td style="text-align:right;">
1.0004216
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000114013.16
</td>
<td style="text-align:left;">
CD86
</td>
<td style="text-align:right;">
0.8269231
</td>
<td style="text-align:left;">
ENSG00000114013
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0663682
</td>
<td style="text-align:right;">
0.3421849
</td>
<td style="text-align:right;">
0.4462872
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000132514.13
</td>
<td style="text-align:left;">
CLEC10A
</td>
<td style="text-align:right;">
0.8181479
</td>
<td style="text-align:left;">
ENSG00000132514
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.3866177
</td>
<td style="text-align:right;">
1.7920233
</td>
<td style="text-align:right;">
3.3907985
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000105967.16
</td>
<td style="text-align:left;">
TFEC
</td>
<td style="text-align:right;">
0.8176975
</td>
<td style="text-align:left;">
ENSG00000105967
</td>
<td style="text-align:left;">
Bcell
</td>
<td style="text-align:right;">
0.0234566
</td>
<td style="text-align:right;">
0.1235314
</td>
<td style="text-align:right;">
0.1023323
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000173369.17
</td>
<td style="text-align:left;">
C1QB
</td>
<td style="text-align:right;">
0.8099608
</td>
<td style="text-align:left;">
ENSG00000173369
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
2.0357169
</td>
<td style="text-align:right;">
13.7189810
</td>
<td style="text-align:right;">
28.4657562
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000177575.12
</td>
<td style="text-align:left;">
CD163
</td>
<td style="text-align:right;">
0.8078951
</td>
<td style="text-align:left;">
ENSG00000177575
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.3361453
</td>
<td style="text-align:right;">
1.8946880
</td>
<td style="text-align:right;">
2.0304719
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000110077.14
</td>
<td style="text-align:left;">
MS4A6A
</td>
<td style="text-align:right;">
0.8063214
</td>
<td style="text-align:left;">
ENSG00000110077
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.4436241
</td>
<td style="text-align:right;">
2.1606915
</td>
<td style="text-align:right;">
3.6416739
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000138180.16
</td>
<td style="text-align:left;">
CEP55
</td>
<td style="text-align:right;">
0.7993619
</td>
<td style="text-align:left;">
ENSG00000138180
</td>
<td style="text-align:left;">
CD4Tcell
</td>
<td style="text-align:right;">
0.0348918
</td>
<td style="text-align:right;">
0.1666287
</td>
<td style="text-align:right;">
0.2252888
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000163599.17
</td>
<td style="text-align:left;">
CTLA4
</td>
<td style="text-align:right;">
0.7880751
</td>
<td style="text-align:left;">
ENSG00000163599
</td>
<td style="text-align:left;">
CD4Tcell
</td>
<td style="text-align:right;">
0.0315704
</td>
<td style="text-align:right;">
0.2644233
</td>
<td style="text-align:right;">
0.1854032
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000166927.13
</td>
<td style="text-align:left;">
MS4A7
</td>
<td style="text-align:right;">
0.7842506
</td>
<td style="text-align:left;">
ENSG00000166927
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.2090296
</td>
<td style="text-align:right;">
1.1084212
</td>
<td style="text-align:right;">
1.9491638
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000170458.14
</td>
<td style="text-align:left;">
CD14
</td>
<td style="text-align:right;">
0.7842175
</td>
<td style="text-align:left;">
ENSG00000170458
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
1.7751882
</td>
<td style="text-align:right;">
7.7468300
</td>
<td style="text-align:right;">
21.4222643
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000124491.16
</td>
<td style="text-align:left;">
F13A1
</td>
<td style="text-align:right;">
0.7788406
</td>
<td style="text-align:left;">
ENSG00000124491
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
2.0078292
</td>
<td style="text-align:right;">
12.2302448
</td>
<td style="text-align:right;">
21.8912499
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000182578.14
</td>
<td style="text-align:left;">
CSF1R
</td>
<td style="text-align:right;">
0.7750512
</td>
<td style="text-align:left;">
ENSG00000182578
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.7874655
</td>
<td style="text-align:right;">
3.3187330
</td>
<td style="text-align:right;">
7.1733571
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000137441.8
</td>
<td style="text-align:left;">
FGFBP2
</td>
<td style="text-align:right;">
0.7745707
</td>
<td style="text-align:left;">
ENSG00000137441
</td>
<td style="text-align:left;">
NKcell
</td>
<td style="text-align:right;">
0.4225620
</td>
<td style="text-align:right;">
3.5214963
</td>
<td style="text-align:right;">
12.7187471
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000161944.16
</td>
<td style="text-align:left;">
ASGR2
</td>
<td style="text-align:right;">
0.7740608
</td>
<td style="text-align:left;">
ENSG00000161944
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.0212327
</td>
<td style="text-align:right;">
0.1023889
</td>
<td style="text-align:right;">
0.1496403
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000282608.2
</td>
<td style="text-align:left;">
ADORA3
</td>
<td style="text-align:right;">
0.7736084
</td>
<td style="text-align:left;">
ENSG00000282608
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0386997
</td>
<td style="text-align:right;">
0.1584448
</td>
<td style="text-align:right;">
0.2628639
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000186818.12
</td>
<td style="text-align:left;">
LILRB4
</td>
<td style="text-align:right;">
0.7629389
</td>
<td style="text-align:left;">
ENSG00000186818
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
0.0032613
</td>
<td style="text-align:right;">
0.0281318
</td>
<td style="text-align:right;">
0.0722317
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000173372.17
</td>
<td style="text-align:left;">
C1QA
</td>
<td style="text-align:right;">
0.7445602
</td>
<td style="text-align:left;">
ENSG00000173372
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
3.4317578
</td>
<td style="text-align:right;">
19.1178534
</td>
<td style="text-align:right;">
52.6300218
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000116824.5
</td>
<td style="text-align:left;">
CD2
</td>
<td style="text-align:right;">
0.7414507
</td>
<td style="text-align:left;">
ENSG00000116824
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
0.5136958
</td>
<td style="text-align:right;">
2.7983896
</td>
<td style="text-align:right;">
3.0646508
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000161921.16
</td>
<td style="text-align:left;">
CXCL16
</td>
<td style="text-align:right;">
0.7398670
</td>
<td style="text-align:left;">
ENSG00000161921
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.3268772
</td>
<td style="text-align:right;">
1.4080810
</td>
<td style="text-align:right;">
5.0737114
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000010327.10
</td>
<td style="text-align:left;">
STAB1
</td>
<td style="text-align:right;">
0.7266172
</td>
<td style="text-align:left;">
ENSG00000010327
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
1.5300961
</td>
<td style="text-align:right;">
5.3923377
</td>
<td style="text-align:right;">
17.3660509
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000103522.16
</td>
<td style="text-align:left;">
IL21R
</td>
<td style="text-align:right;">
0.7225309
</td>
<td style="text-align:left;">
ENSG00000103522
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
0.0288943
</td>
<td style="text-align:right;">
0.4792686
</td>
<td style="text-align:right;">
0.1039427
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000110079.18
</td>
<td style="text-align:left;">
MS4A4A
</td>
<td style="text-align:right;">
0.7206380
</td>
<td style="text-align:left;">
ENSG00000110079
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1930113
</td>
<td style="text-align:right;">
1.0180924
</td>
<td style="text-align:right;">
2.7351409
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000078081.8
</td>
<td style="text-align:left;">
LAMP3
</td>
<td style="text-align:right;">
0.7185273
</td>
<td style="text-align:left;">
ENSG00000078081
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0108336
</td>
<td style="text-align:right;">
0.1663221
</td>
<td style="text-align:right;">
0.2174447
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000090104.12
</td>
<td style="text-align:left;">
RGS1
</td>
<td style="text-align:right;">
0.7173044
</td>
<td style="text-align:left;">
ENSG00000090104
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0130089
</td>
<td style="text-align:right;">
0.2018628
</td>
<td style="text-align:right;">
0.1915478
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000143320.9
</td>
<td style="text-align:left;">
CRABP2
</td>
<td style="text-align:right;">
0.7144369
</td>
<td style="text-align:left;">
ENSG00000143320
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.6114227
</td>
<td style="text-align:right;">
3.8166488
</td>
<td style="text-align:right;">
13.9456375
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000019169.10
</td>
<td style="text-align:left;">
MARCO
</td>
<td style="text-align:right;">
0.7105930
</td>
<td style="text-align:left;">
ENSG00000019169
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1199304
</td>
<td style="text-align:right;">
0.6352074
</td>
<td style="text-align:right;">
1.9900735
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000184060.11
</td>
<td style="text-align:left;">
ADAP2
</td>
<td style="text-align:right;">
0.7103740
</td>
<td style="text-align:left;">
ENSG00000184060
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.3838474
</td>
<td style="text-align:right;">
1.1441190
</td>
<td style="text-align:right;">
3.2110364
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000166278.15
</td>
<td style="text-align:left;">
C2
</td>
<td style="text-align:right;">
0.7007918
</td>
<td style="text-align:left;">
ENSG00000166278
</td>
<td style="text-align:left;">
PlasmaCell
</td>
<td style="text-align:right;">
0.0039973
</td>
<td style="text-align:right;">
0.0403557
</td>
<td style="text-align:right;">
0.1117194
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000110492.15
</td>
<td style="text-align:left;">
MDK
</td>
<td style="text-align:right;">
0.7003678
</td>
<td style="text-align:left;">
ENSG00000110492
</td>
<td style="text-align:left;">
PlasmaCell
</td>
<td style="text-align:right;">
0.5089112
</td>
<td style="text-align:right;">
2.5043028
</td>
<td style="text-align:right;">
13.2510295
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000181458.10
</td>
<td style="text-align:left;">
TMEM45A
</td>
<td style="text-align:right;">
0.7003172
</td>
<td style="text-align:left;">
ENSG00000181458
</td>
<td style="text-align:left;">
PlasmaCell
</td>
<td style="text-align:right;">
0.0529060
</td>
<td style="text-align:right;">
0.3722313
</td>
<td style="text-align:right;">
1.0593557
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000104951.16
</td>
<td style="text-align:left;">
IL4I1
</td>
<td style="text-align:right;">
0.6975342
</td>
<td style="text-align:left;">
ENSG00000104951
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0220052
</td>
<td style="text-align:right;">
0.3013386
</td>
<td style="text-align:right;">
0.1689496
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000077238.14
</td>
<td style="text-align:left;">
IL4R
</td>
<td style="text-align:right;">
0.6970081
</td>
<td style="text-align:left;">
ENSG00000077238
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
0.9802568
</td>
<td style="text-align:right;">
3.5371779
</td>
<td style="text-align:right;">
15.3524367
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000157227.13
</td>
<td style="text-align:left;">
MMP14
</td>
<td style="text-align:right;">
0.6813758
</td>
<td style="text-align:left;">
ENSG00000157227
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
2.4939224
</td>
<td style="text-align:right;">
10.9206905
</td>
<td style="text-align:right;">
68.0308145
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000143387.13
</td>
<td style="text-align:left;">
CTSK
</td>
<td style="text-align:right;">
0.6812790
</td>
<td style="text-align:left;">
ENSG00000143387
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
2.5631582
</td>
<td style="text-align:right;">
12.3782990
</td>
<td style="text-align:right;">
70.4075115
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000038427.16
</td>
<td style="text-align:left;">
VCAN
</td>
<td style="text-align:right;">
0.6795530
</td>
<td style="text-align:left;">
ENSG00000038427
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.5364233
</td>
<td style="text-align:right;">
2.1562978
</td>
<td style="text-align:right;">
3.3628331
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000172724.12
</td>
<td style="text-align:left;">
CCL19
</td>
<td style="text-align:right;">
0.6771104
</td>
<td style="text-align:left;">
ENSG00000172724
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
0.0506337
</td>
<td style="text-align:right;">
2.0168338
</td>
<td style="text-align:right;">
34.8952268
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000120708.17
</td>
<td style="text-align:left;">
TGFBI
</td>
<td style="text-align:right;">
0.6748693
</td>
<td style="text-align:left;">
ENSG00000120708
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
2.4659110
</td>
<td style="text-align:right;">
8.9473151
</td>
<td style="text-align:right;">
33.0267668
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000002933.9
</td>
<td style="text-align:left;">
TMEM176A
</td>
<td style="text-align:right;">
0.6728172
</td>
<td style="text-align:left;">
ENSG00000002933
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.3762751
</td>
<td style="text-align:right;">
1.8857893
</td>
<td style="text-align:right;">
11.2110257
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000171848.15
</td>
<td style="text-align:left;">
RRM2
</td>
<td style="text-align:right;">
0.6609791
</td>
<td style="text-align:left;">
ENSG00000171848
</td>
<td style="text-align:left;">
CD4Tcell
</td>
<td style="text-align:right;">
0.0090876
</td>
<td style="text-align:right;">
0.0662736
</td>
<td style="text-align:right;">
0.1102069
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000169245.6
</td>
<td style="text-align:left;">
CXCL10
</td>
<td style="text-align:right;">
0.6550995
</td>
<td style="text-align:left;">
ENSG00000169245
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.5894382
</td>
<td style="text-align:right;">
5.9803700
</td>
<td style="text-align:right;">
2.1547531
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000166888.12
</td>
<td style="text-align:left;">
STAT6
</td>
<td style="text-align:right;">
0.6500805
</td>
<td style="text-align:left;">
ENSG00000166888
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
1.7841065
</td>
<td style="text-align:right;">
5.8704648
</td>
<td style="text-align:right;">
30.1303223
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000133048.13
</td>
<td style="text-align:left;">
CHI3L1
</td>
<td style="text-align:right;">
0.6346830
</td>
<td style="text-align:left;">
ENSG00000133048
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1946220
</td>
<td style="text-align:right;">
2.1621032
</td>
<td style="text-align:right;">
2.7397122
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000010610.10
</td>
<td style="text-align:left;">
CD4
</td>
<td style="text-align:right;">
0.6261569
</td>
<td style="text-align:left;">
ENSG00000010610
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
0.5141389
</td>
<td style="text-align:right;">
2.7303825
</td>
<td style="text-align:right;">
27.4443352
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000174807.4
</td>
<td style="text-align:left;">
CD248
</td>
<td style="text-align:right;">
0.6261514
</td>
<td style="text-align:left;">
ENSG00000174807
</td>
<td style="text-align:left;">
CD8Tcell
</td>
<td style="text-align:right;">
14.3514643
</td>
<td style="text-align:right;">
48.2904687
</td>
<td style="text-align:right;">
253.0578657
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000198794.12
</td>
<td style="text-align:left;">
SCAMP5
</td>
<td style="text-align:right;">
0.6259889
</td>
<td style="text-align:left;">
ENSG00000198794
</td>
<td style="text-align:left;">
PlasmaCell
</td>
<td style="text-align:right;">
0.0735910
</td>
<td style="text-align:right;">
0.4475840
</td>
<td style="text-align:right;">
2.3682200
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000165140.11
</td>
<td style="text-align:left;">
FBP1
</td>
<td style="text-align:right;">
0.6256957
</td>
<td style="text-align:left;">
ENSG00000165140
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1543315
</td>
<td style="text-align:right;">
0.6023780
</td>
<td style="text-align:right;">
3.7040663
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000137801.11
</td>
<td style="text-align:left;">
THBS1
</td>
<td style="text-align:right;">
0.5769849
</td>
<td style="text-align:left;">
ENSG00000137801
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.8099008
</td>
<td style="text-align:right;">
5.0986959
</td>
<td style="text-align:right;">
17.6310690
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000100365.16
</td>
<td style="text-align:left;">
NCF4
</td>
<td style="text-align:right;">
0.5626164
</td>
<td style="text-align:left;">
ENSG00000100365
</td>
<td style="text-align:left;">
Neutrophil
</td>
<td style="text-align:right;">
0.3574015
</td>
<td style="text-align:right;">
1.3059616
</td>
<td style="text-align:right;">
3.1460980
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000141505.12
</td>
<td style="text-align:left;">
ASGR1
</td>
<td style="text-align:right;">
0.5509758
</td>
<td style="text-align:left;">
ENSG00000141505
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.0351094
</td>
<td style="text-align:right;">
0.1354246
</td>
<td style="text-align:right;">
0.6025999
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000142552.8
</td>
<td style="text-align:left;">
RCN3
</td>
<td style="text-align:right;">
0.5367903
</td>
<td style="text-align:left;">
ENSG00000142552
</td>
<td style="text-align:left;">
PlasmaCell
</td>
<td style="text-align:right;">
3.1691866
</td>
<td style="text-align:right;">
10.1816596
</td>
<td style="text-align:right;">
48.4596901
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000171812.13
</td>
<td style="text-align:left;">
COL8A2
</td>
<td style="text-align:right;">
0.5351123
</td>
<td style="text-align:left;">
ENSG00000171812
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1500623
</td>
<td style="text-align:right;">
0.9979313
</td>
<td style="text-align:right;">
3.0772092
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000132205.11
</td>
<td style="text-align:left;">
EMILIN2
</td>
<td style="text-align:right;">
0.5297056
</td>
<td style="text-align:left;">
ENSG00000132205
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.3997817
</td>
<td style="text-align:right;">
1.9355804
</td>
<td style="text-align:right;">
10.0447402
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000108846.16
</td>
<td style="text-align:left;">
ABCC3
</td>
<td style="text-align:right;">
0.5169606
</td>
<td style="text-align:left;">
ENSG00000108846
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0253774
</td>
<td style="text-align:right;">
0.2010368
</td>
<td style="text-align:right;">
0.4090524
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000060558.4
</td>
<td style="text-align:left;">
GNA15
</td>
<td style="text-align:right;">
0.5164559
</td>
<td style="text-align:left;">
ENSG00000060558
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1154703
</td>
<td style="text-align:right;">
0.6176169
</td>
<td style="text-align:right;">
1.4995404
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000155659.15
</td>
<td style="text-align:left;">
VSIG4
</td>
<td style="text-align:right;">
0.5133328
</td>
<td style="text-align:left;">
ENSG00000155659
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.5261769
</td>
<td style="text-align:right;">
2.2279206
</td>
<td style="text-align:right;">
4.3380216
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000088827.12
</td>
<td style="text-align:left;">
SIGLEC1
</td>
<td style="text-align:right;">
0.5044042
</td>
<td style="text-align:left;">
ENSG00000088827
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
1.0464540
</td>
<td style="text-align:right;">
4.0403822
</td>
<td style="text-align:right;">
10.0460345
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000100979.15
</td>
<td style="text-align:left;">
PLTP
</td>
<td style="text-align:right;">
0.5012153
</td>
<td style="text-align:left;">
ENSG00000100979
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
1.8178334
</td>
<td style="text-align:right;">
9.1650567
</td>
<td style="text-align:right;">
44.0062775
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000166145.14
</td>
<td style="text-align:left;">
SPINT1
</td>
<td style="text-align:right;">
0.5003076
</td>
<td style="text-align:left;">
ENSG00000166145
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0426139
</td>
<td style="text-align:right;">
0.1894087
</td>
<td style="text-align:right;">
0.7413172
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000100985.7
</td>
<td style="text-align:left;">
MMP9
</td>
<td style="text-align:right;">
0.4984437
</td>
<td style="text-align:left;">
ENSG00000100985
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.1003691
</td>
<td style="text-align:right;">
1.5203490
</td>
<td style="text-align:right;">
8.2657241
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000187474.5
</td>
<td style="text-align:left;">
FPR3
</td>
<td style="text-align:right;">
0.4933989
</td>
<td style="text-align:left;">
ENSG00000187474
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.3026753
</td>
<td style="text-align:right;">
1.7773001
</td>
<td style="text-align:right;">
1.9219966
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000139572.4
</td>
<td style="text-align:left;">
GPR84
</td>
<td style="text-align:right;">
0.4751397
</td>
<td style="text-align:left;">
ENSG00000139572
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.0077004
</td>
<td style="text-align:right;">
0.0773290
</td>
<td style="text-align:right;">
0.0618142
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000105609.17
</td>
<td style="text-align:left;">
LILRB5
</td>
<td style="text-align:right;">
0.4640090
</td>
<td style="text-align:left;">
ENSG00000105609
</td>
<td style="text-align:left;">
Others
</td>
<td style="text-align:right;">
0.1857144
</td>
<td style="text-align:right;">
0.7666013
</td>
<td style="text-align:right;">
1.9553274
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000090659.18
</td>
<td style="text-align:left;">
CD209
</td>
<td style="text-align:right;">
0.4608114
</td>
<td style="text-align:left;">
ENSG00000090659
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.2322114
</td>
<td style="text-align:right;">
1.2533845
</td>
<td style="text-align:right;">
3.3028487
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000176014.13
</td>
<td style="text-align:left;">
TUBB6
</td>
<td style="text-align:right;">
0.4602100
</td>
<td style="text-align:left;">
ENSG00000176014
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
3.5972900
</td>
<td style="text-align:right;">
11.0828601
</td>
<td style="text-align:right;">
48.3484150
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000118785.14
</td>
<td style="text-align:left;">
SPP1
</td>
<td style="text-align:right;">
0.4479528
</td>
<td style="text-align:left;">
ENSG00000118785
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.0207772
</td>
<td style="text-align:right;">
1.1074521
</td>
<td style="text-align:right;">
1.8615908
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000011422.12
</td>
<td style="text-align:left;">
PLAUR
</td>
<td style="text-align:right;">
0.4301508
</td>
<td style="text-align:left;">
ENSG00000011422
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
0.1783956
</td>
<td style="text-align:right;">
0.5793819
</td>
<td style="text-align:right;">
2.2774659
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000125730.17
</td>
<td style="text-align:left;">
C3
</td>
<td style="text-align:right;">
0.4263273
</td>
<td style="text-align:left;">
ENSG00000125730
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
4.4394449
</td>
<td style="text-align:right;">
25.6278376
</td>
<td style="text-align:right;">
67.5924876
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000141753.7
</td>
<td style="text-align:left;">
IGFBP4
</td>
<td style="text-align:right;">
0.3779018
</td>
<td style="text-align:left;">
ENSG00000141753
</td>
<td style="text-align:left;">
DendriticCell
</td>
<td style="text-align:right;">
47.2044767
</td>
<td style="text-align:right;">
167.3634231
</td>
<td style="text-align:right;">
1281.8420877
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000134668.12
</td>
<td style="text-align:left;">
SPOCD1
</td>
<td style="text-align:right;">
0.3293381
</td>
<td style="text-align:left;">
ENSG00000134668
</td>
<td style="text-align:left;">
Monocyte
</td>
<td style="text-align:right;">
0.0101972
</td>
<td style="text-align:right;">
0.0482261
</td>
<td style="text-align:right;">
0.3785615
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="top-loading-variables-by-the-plier-package" class="section level3" number="9.6.2">
<h3>
<span class="header-section-number">9.6.2</span> Top loading variables by the PLIER package<a class="anchor" aria-label="anchor" href="#top-loading-variables-by-the-plier-package"><i class="fas fa-link"></i></a>
</h3>
<p>Previously, we used The PLIER package to estimate the immune cell type contributions to FSHD transcriptome. The top Z, loading variables, are important in determining the relative proportion of the immune cell type contribution. Listed below are the top loading variables. Note that they are not necessary exhibiting strong expression levels.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">pkg_dir</span>, <span class="st">"data"</span>, <span class="st">"plier_topZ_markers.rda"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="va">plier_topZ_markers</span><span class="op">$</span><span class="va">bilat_markers</span></span>
<span><span class="va">gene_cor_topZ</span> <span class="op">&lt;-</span> <span class="fu">.markers_bilateral_correlation</span><span class="op">(</span>markers<span class="op">=</span><span class="va">markers</span>,</span>
<span>                                           dds<span class="op">=</span><span class="va">bilat_dds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="fu">.avg_TPM_by_class</span><span class="op">(</span>markers <span class="op">=</span> <span class="va">markers</span>, dds<span class="op">=</span><span class="va">bilat_dds</span><span class="op">)</span>, </span>
<span>                   by<span class="op">=</span><span class="st">"gene_id"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_cor_topZ</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Pearson_by_TPM</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Identified by the PLIER package, listed below are the 18 top Z markers contributed to cell type proportions in bilateral study. The Peason correlation coefficients are compuated using the expression levels presented by Log10(TPM+1)."</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:plier-markers">Table 9.3: </span>Identified by the PLIER package, listed below are the 18 top Z markers contributed to cell type proportions in bilateral study. The Peason correlation coefficients are compuated using the expression levels presented by Log10(TPM+1).
</caption>
<thead><tr>
<th style="text-align:left;">
gene_id
</th>
<th style="text-align:left;">
gene_name
</th>
<th style="text-align:right;">
Pearson_by_log10TPM
</th>
<th style="text-align:left;">
LV_index
</th>
<th style="text-align:left;">
cell_type
</th>
<th style="text-align:left;">
ens_id
</th>
<th style="text-align:right;">
Control-like avg TPM
</th>
<th style="text-align:right;">
Moderate+ avg TPM
</th>
<th style="text-align:right;">
Muscle-Low avg TPM
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
ENSG00000110777.12
</td>
<td style="text-align:left;">
POU2AF1
</td>
<td style="text-align:right;">
0.9220746
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000110777
</td>
<td style="text-align:right;">
0.0312330
</td>
<td style="text-align:right;">
0.3724736
</td>
<td style="text-align:right;">
0.1057589
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000136573.14
</td>
<td style="text-align:left;">
BLK
</td>
<td style="text-align:right;">
0.8141694
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000136573
</td>
<td style="text-align:right;">
0.0108037
</td>
<td style="text-align:right;">
0.1151240
</td>
<td style="text-align:right;">
0.0270017
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000110077.14
</td>
<td style="text-align:left;">
MS4A6A
</td>
<td style="text-align:right;">
0.8063214
</td>
<td style="text-align:left;">
20,IRIS_DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
ENSG00000110077
</td>
<td style="text-align:right;">
0.4436241
</td>
<td style="text-align:right;">
2.1606915
</td>
<td style="text-align:right;">
3.6416739
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000177455.15
</td>
<td style="text-align:left;">
CD19
</td>
<td style="text-align:right;">
0.7963163
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000177455
</td>
<td style="text-align:right;">
0.0199848
</td>
<td style="text-align:right;">
0.1477995
</td>
<td style="text-align:right;">
0.0461397
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000166927.13
</td>
<td style="text-align:left;">
MS4A7
</td>
<td style="text-align:right;">
0.7842506
</td>
<td style="text-align:left;">
20,IRIS_DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
ENSG00000166927
</td>
<td style="text-align:right;">
0.2090296
</td>
<td style="text-align:right;">
1.1084212
</td>
<td style="text-align:right;">
1.9491638
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000132704.16
</td>
<td style="text-align:left;">
FCRL2
</td>
<td style="text-align:right;">
0.7786763
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000132704
</td>
<td style="text-align:right;">
0.0216208
</td>
<td style="text-align:right;">
0.1253008
</td>
<td style="text-align:right;">
0.0336529
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000282608.2
</td>
<td style="text-align:left;">
ADORA3
</td>
<td style="text-align:right;">
0.7736084
</td>
<td style="text-align:left;">
20,IRIS_DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
ENSG00000282608
</td>
<td style="text-align:right;">
0.0386997
</td>
<td style="text-align:right;">
0.1584448
</td>
<td style="text-align:right;">
0.2628639
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000156738.18
</td>
<td style="text-align:left;">
MS4A1
</td>
<td style="text-align:right;">
0.6979562
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000156738
</td>
<td style="text-align:right;">
0.0939018
</td>
<td style="text-align:right;">
0.5551574
</td>
<td style="text-align:right;">
0.1685982
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000119866.22
</td>
<td style="text-align:left;">
BCL11A
</td>
<td style="text-align:right;">
0.6909547
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000119866
</td>
<td style="text-align:right;">
0.0025620
</td>
<td style="text-align:right;">
0.0148748
</td>
<td style="text-align:right;">
0.0093517
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000174123.11
</td>
<td style="text-align:left;">
TLR10
</td>
<td style="text-align:right;">
0.6724404
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000174123
</td>
<td style="text-align:right;">
0.0186041
</td>
<td style="text-align:right;">
0.0667165
</td>
<td style="text-align:right;">
0.0748956
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000128218.8
</td>
<td style="text-align:left;">
VPREB3
</td>
<td style="text-align:right;">
0.5787516
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000128218
</td>
<td style="text-align:right;">
0.3698683
</td>
<td style="text-align:right;">
0.8011012
</td>
<td style="text-align:right;">
0.5077516
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000117322.18
</td>
<td style="text-align:left;">
CR2
</td>
<td style="text-align:right;">
0.5075859
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000117322
</td>
<td style="text-align:right;">
0.0166510
</td>
<td style="text-align:right;">
0.0830997
</td>
<td style="text-align:right;">
0.0050237
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000187474.5
</td>
<td style="text-align:left;">
FPR3
</td>
<td style="text-align:right;">
0.4933989
</td>
<td style="text-align:left;">
20,IRIS_DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
ENSG00000187474
</td>
<td style="text-align:right;">
0.3026753
</td>
<td style="text-align:right;">
1.7773001
</td>
<td style="text-align:right;">
1.9219966
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000158477.7
</td>
<td style="text-align:left;">
CD1A
</td>
<td style="text-align:right;">
0.4457300
</td>
<td style="text-align:left;">
20,IRIS_DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
DendriticCell-LPSstimulated
</td>
<td style="text-align:left;">
ENSG00000158477
</td>
<td style="text-align:right;">
0.0171722
</td>
<td style="text-align:right;">
0.0480016
</td>
<td style="text-align:right;">
0.1425001
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000163534.15
</td>
<td style="text-align:left;">
FCRL1
</td>
<td style="text-align:right;">
0.3398749
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000163534
</td>
<td style="text-align:right;">
0.0200861
</td>
<td style="text-align:right;">
0.0731329
</td>
<td style="text-align:right;">
0.0216181
</td>
</tr>
<tr>
<td style="text-align:left;">
ENSG00000196092.14
</td>
<td style="text-align:left;">
PAX5
</td>
<td style="text-align:right;">
0.3205516
</td>
<td style="text-align:left;">
2,IRIS_Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
Bcell-Memory_IgG_IgA
</td>
<td style="text-align:left;">
ENSG00000196092
</td>
<td style="text-align:right;">
0.0535907
</td>
<td style="text-align:right;">
0.0706754
</td>
<td style="text-align:right;">
0.0370464
</td>
</tr>
</tbody>
</table></div>
<p>Check the scatter plot: TPM on x and y coordinates are displayed in log10 scale.</p>
<div class="inline-figure"><img src="08-immune-cell-infiltrates-signature_files/figure-html/some-sig-markers-bcell-1.png" width="672"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="bilateral-comparison.html"><span class="header-section-number">8</span> Bilateral comparison</a></div>
<div class="next"><a href="complement-scoring.html"><span class="header-section-number">10</span> Complement scoring</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#immune-cell-infiltrates"><span class="header-section-number">9</span> Immune cell infiltrates signature</a></li>
<li><a class="nav-link" href="#enriched-biological-processes-directly-associated-with-tb-cells"><span class="header-section-number">9.1</span> Enriched biological processes directly associated with T/B cells</a></li>
<li>
<a class="nav-link" href="#significant-genes-associated-with-the-tb-associated-enriched-go-terms"><span class="header-section-number">9.2</span> Significant genes associated with the T/B-associated enriched GO terms</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#heatmap-longitudinal-study"><span class="header-section-number">9.2.1</span> Heatmap: Longitudinal study</a></li>
<li><a class="nav-link" href="#heatmap-bilateral-study"><span class="header-section-number">9.2.2</span> Heatmap: bilateral study</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#immune-cell-infiltrate-signature"><span class="header-section-number">9.3</span> Immune cell infiltrate signature</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#viz-the-immune-cell-infiltrate-siganiture-from-the-longitudinal-study"><span class="header-section-number">9.3.1</span> Viz the immune cell infiltrate siganiture from the longitudinal study</a></li>
<li><a class="nav-link" href="#bilateral-study"><span class="header-section-number">9.3.2</span> Bilateral study</a></li>
</ul>
</li>
<li><a class="nav-link" href="#complement-scoring-vs.-immune-cell-infiltrates-signature"><span class="header-section-number">9.4</span> Complement scoring vs. immune cell infiltrates signature</a></li>
<li><a class="nav-link" href="#stir-status-vs.-immune-cell-infiltrates-signature"><span class="header-section-number">9.5</span> STIR status vs. immune cell infiltrates signature</a></li>
<li>
<a class="nav-link" href="#bilateral-comparison-analysis-for-the-immune-cell-infiltrate-markers"><span class="header-section-number">9.6</span> Bilateral comparison analysis for the immune cell infiltrate markers</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#significant-immune-cell-markers"><span class="header-section-number">9.6.1</span> 63 significant immune cell markers</a></li>
<li><a class="nav-link" href="#top-loading-variables-by-the-plier-package"><span class="header-section-number">9.6.2</span> Top loading variables by the PLIER package</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/FredHutch/Wellstone_BiLateral_Biopsy/blob/master/gitbook/08-immune-cell-infiltrates-signature.Rmd">View source <i class="fas fa-air-freshener"></i></a></li>
          <li><a id="book-edit" href="https://github.com/FredHutch/Wellstone_BiLateral_Biopsy/edit/master/gitbook/08-immune-cell-infiltrates-signature.Rmd">Edit this page <i class="fas fa-air-freshener"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Wellstone bilateral tibialis anterior FSHD biopsied muscle study</strong>" was written by Chao-Jen Wong. It was last built on 2023-04-10.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
