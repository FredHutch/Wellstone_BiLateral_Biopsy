[{"path":"index.html","id":"about","chapter":"1 About","heading":"1 About","text":"gitbook written support publication’s computational transparency reproducibility, Validation study association MRI FSHD gene signature reveals markers whole muscle systemic disease progression.data analyses study included RNA-seq hypothesis-based classification-based differential analysis, machine learning, linear regression, correlation analysis, logistics regression. book, included adequate details choose approaches present readable, reproducible code generates results fly.following sections discuss software used data analysis, material included repository, build Bioconductor transcript-based database (TxDB) package used RNA-seq data analysis, finally RNA-seq data preprocessing read counts.","code":""},{"path":"index.html","id":"software","chapter":"1 About","heading":"1.1 Software","text":"R (4.2.2) packages Bioconductor (3.17) Tidyverse projects. used packages include GenomicAlignments, GenomicFeatures, DESeq2, dplyr, ggplot2, caret, genomic-related BioC packages annotation.","code":""},{"path":"index.html","id":"data-sets","chapter":"1 About","heading":"1.2 Data sets","text":"RNA-seq gene expression: DESeqDataSet instances obtaining gene counts, TPM, RPKM, well range annotation dataMRI characteristics including regional fat fraction, whole muscle fat percent, STIR ratingClinical data including histopathological scores, muscle strength, clinical severity scoreMethylation percentage Bisulfite sequencing","code":""},{"path":"index.html","id":"repos-structure","chapter":"1 About","heading":"1.3 Repos structure","text":"","code":"\\data: \n    |- sanitized.dds.rda: DESeqDataSet instance; longitudinal RNA-seq\n    |- cluster_df.rda: data.frame instance\n    |- dds.rda: DESeqDataSet instance; bilateral RNA-seq data\n    |- comprehensive_df.rda: data.frame instance obtaining \n       clinical, MRI, and methylation data\n\n\\docs: *.html; folder hosts the gitbook \n\\gitbook: *.Rmd that makes the gitbook\n\\scripts: *.R; un-orgnaized R code of our initial data \n          exploration and bioinformatics analysis\n\\extdata: *.xlsx; supplemental tables"},{"path":"index.html","id":"annotation-package","chapter":"1 About","heading":"1.4 Annotation package","text":"annotation used analysis collected Gencode v35. code chunk example building customized TxDB package, named hg38.HomoSapiens.Gencode.v35, bioinformatics analysis.","code":""},{"path":"index.html","id":"build-txdb-package-from-gtf","chapter":"1 About","heading":"1.4.1 Build TxDB package from GTF","text":"steps :Transform downloaded Gencode v35 GTF file GRange instanceConvert GRange instance TxDB packageInclude gene annotation (gene_name, gene_type, gene_ID, gene_type) DataFrame instance data folder packageThe downside TxDB package carry corresponding columns gene_name, gene_type, gene_symbols original GTF file obtained. adding DataFrame instance include information might provide convenience future usage.","code":"\nlibrary(rtracklayer)\nlibrary(GenomicFeatures)\n\n## Define the destination and package name of your TxDB package\npkg_name <- \"hg38.HomoSapiens.Gencode.v35\"\ndest_dir <- \"/fh/fast/tapscott_s/CompBio/hg38\"\n\n## Where is my GTF file\ngtf_file <- \"/fh/fast/tapscott_s/CompBio/genome_reference/GRCh38/Annotation/gencode.v35.annotation.gtf\"\n\n## Import the GTF file into a GRange instance\ngencode <- rtracklayer::import.gff(gtf_file)\n\n## Define metadata: version, source, and etc.\norganism <- \"human\"\nrelease <- \"v35\"\ndataSource <- paste0(\"ftp://ftp.sanger.ac.uk/pub/gencode/Gencode_\",\n                     organism, \"/\", release)\nmetadata <- data.frame(\n  name=c(\"Organism\", \"Resource URL\", \"Resource GTF file\",\n         \"Taxonomy ID\", \"miRBase build ID\", \"Data source\"),\n  value=c(\"Homo sapiens\", dataSource, gtf_file, NA, NA, dataSource))\n\n## Prepare the metadata\nmetadata <- GenomicFeatures:::.prepareGFFMetadata(gtf_file, dataSource,\n                                                  organism=\"Homo sapiens\")\n\n## Combine the GRange instance and metadata into a TxDB instance\ntxdb <- GenomicFeatures:::makeTxDbFromGRanges(gr=gencode,\n                                              metadata=metadata)\n\n## Build a TxDb package\nmakeTxDbPackage(txdb, version=\"3.6.2\", author=\"Chao-Jen Wong\",\n                pkgname=pkg_name, destDir=dest_dir, license=\"Artistic-2.0\",\n                provider=\"Gencode\", providerVersion=release,\n                maintainer=\"Chao-Jen Wong <cwon2@fredhutch.org>\")\ngene.anno <- mcols(gencode)[gencode$type==\"gene\", ]\nrownames(gene.anno) <- gene.anno$gene_id\n\n#' put annotation to the data directory\ndata_dir <- file.path(dest_dir, pkg_name, \"data\")\nif (!file.exists(data_dir))\n    dir.create(data_dir)\nsave(gene.anno, file=file.path(data_dir, \"gene.anno.rda\"))"},{"path":"index.html","id":"build-ensdb-package-using-annotationhub","chapter":"1 About","heading":"1.4.2 Build EnsDb package using AnnotationHub","text":"retrospect, use AnnotationHub() GenomicFeatures::makeEnsembldbPackage() make EnsDB package instead TxDB EnsDB slots/functions retrieve gene information. example:","code":"\n#'\n#' EnsDb.Hsapiens.v92: \n#'\nlibrary(AnnotationHub)\nlibrary(GenomicFeatures)\nah <- AnnotationHub()\nquery(ah, c(\"hsapiens\"))\nedb <- ah[[\"AH60977\"]]\nseqlevelsStyle(edb) <- \"NCBI\"\nmakeEnsembldbPackage(ensdb=dbfile(dbconn(edb)), version=\"1.0.0\",\n                     maintainer=\"Chao-Jen Wong <cwon2@fredhutch.org>\",\n                     author=\"Chao-Jen Wong\",\n                     destDir=\"/fh/fast//tapscott_s/CompBio/hg38\")"},{"path":"index.html","id":"preprocessing-and-gene-counts","chapter":"1 About","heading":"1.5 Preprocessing and gene counts","text":"RNA-seq data preprocessing, filtered unqualified raw reads, trimmed Illumina universal adapters Trimmomatic, aligned reads GRCh38.p13 Rsubread.code chunk shows example use GenomicAlignments, BiocParallel, customized TxDB (hg38.HomoSapiens.Gencode.v35) packages count reads make RangedSummarizedExperiment instance. NOTE: sort_files indicated location sorted, indexed BAM files.assigned parameters summarizOverlaps() function preference mode counting reads completely fall within range exons ignoring ambiguous reads straddling different gene features.","code":"\n# sort_files gives the location of my bam files\nsort_files <- list.files(scratch_dir, full.name=TRUE, pattern=\"\\\\.bam$\")\nlibrary(GenomicFeatures)\nlibrary(GenomicAlignments)\nlibrary(Rsamtools)\nlibrary(BiocParallel)\nlibrary(hg38.HomoSapiens.Gencode.v35)\nbp_param <- BiocParallel::MulticoreParam(workers=12L)\nregister(bp_param)\n\nfeatures <- GenomicFeatures::exonsBy(hg38.HomoSapiens.Gencode.v35, by=\"gene\")\nfeatures <- keepStandardChromosomes(features,\n                                    species = \"Homo_sapiens\",\n                                    pruning.mode=\"fine\")\nrse <- GenomicAlignments::summarizeOverlaps(features=features,\n                                            reads = Rsamtools::BamFileList(sort_file),\n                                            mode = \"IntersectionStrict\",\n                                            ignore.strand=TRUE, \n                                            singleEnd=TRUE,\n                                            inter.feature=TRUE, \n                                            BPPARAM=bp_param)"},{"path":"study-cohort.html","id":"study-cohort","chapter":"2 Study cohort","heading":"2 Study cohort","text":"Wellstone Bilateral muscle biopsy study cohort include 34 subjects, aged 21 69, recruited three medical institutes, University Washington Medical Center, University Rochester Medical Center, Kansas University Medical Center. participated subjects underwent needle muscle biopsy tibialis anterior (TA) muscles. muscle biopsies (n=68) processed MRI characterization, histopathological scoring, RNA extraction RNA sequencing , DNA extraction bisulfite sequencing 4qA permissive allele region exon 2-3. attempted biopsies adequate least one two processes, include:01-0019L, 01-0020R, 01-0029R, 13-0006R adequate histopathological scoring13-0006R, 13-0008R/L yield sufficient RNA RNA sequencing32-0028L low RNA Integrity number (RIN=4) showed RND degradation","code":""},{"path":"muscle-content.html","id":"muscle-content","chapter":"3 Transcript-based accessment for muscle content","heading":"3 Transcript-based accessment for muscle content","text":"Coming soon.","code":""},{"path":"mri-fat.html","id":"mri-fat","chapter":"4 MRI fat infiltration","heading":"4 MRI fat infiltration","text":"Updating.","code":""},{"path":"MRI-vs-DUX4-score.html","id":"MRI-vs-DUX4-score","chapter":"5 MRI characteristics and DUX4 molecular signatures","heading":"5 MRI characteristics and DUX4 molecular signatures","text":"chapter, weAddress association MRI characteristics DUX4 signaturesConsider two approaches determine DUX4 signature occurrences: (1) threshold DUX4 score–accumulated \\(\\log_{10}(TPM+1)\\) six robust DUX4 genes, (2) prediction training model built upon longitudinal study random forestApply logistics regression using linear combination STIR status fat infiltration percent outcome DUX4 expression occurrence. Output logistics regression function.","code":""},{"path":"MRI-vs-DUX4-score.html","id":"stir-status-and-dux4-signatures","chapter":"5 MRI characteristics and DUX4 molecular signatures","heading":"5.1 STIR status and DUX4 signatures","text":"\nTable 5.1: Mean values DUX4 scores (based DUX4-M6 basket) STIR+ STIR- biopsies.\nmean difference DUX4 scores STIR+ STIR- groups significantly greater 0 Wilcox \\(p\\)-value \\(7e-10\\).","code":"#> \n#>  Wilcoxon rank sum exact test\n#> \n#> data:  dux4_list[[1]] and dux4_list[[2]]\n#> W = 815, p-value = 7.315e-10\n#> alternative hypothesis: true location shift is not equal to 0"},{"path":"MRI-vs-DUX4-score.html","id":"logistics-prediction-of-dux4-signature-occurrence","chapter":"5 MRI characteristics and DUX4 molecular signatures","heading":"5.2 Logistics prediction of DUX4 signature occurrence","text":"","code":""},{"path":"MRI-vs-DUX4-score.html","id":"scheme-1-use-random-forest-traning-model-based-on-dux4-m6-basket","chapter":"5 MRI characteristics and DUX4 molecular signatures","heading":"5.2.1 Scheme 1: use random forest traning model based on DUX4 M6 basket","text":"first scheme used random forest training model built longitudinal model six DUX4 basket genes. applied ML model bilateral samples classify DUX4+ DUX4- groups. got 60% STIR- samples DUX4+.\nTable 5.2: STIR+ - distribution DUX4+/- group.\ngeneral linear model depicted STIR status key association DUX4 signatures whereas fat infiltration fraction presented less solid evident direct association (p-value=0.3).code chunk applies logistic regression using fat infiltration percent STIR status predictors outcome DUX4 signature occurrence predicted random forest:\nFigure 5.1: Prediction DUX4 + ocurrence modeled linear combination STIR_status FAT_Infilt_Percent. red linepresents STIR+ blue STIR-.\n","code":"#> # A tibble: 2 × 4\n#>   rfM6_fit average_DUX4_score min_DUX4_score max_DUX4_score\n#>   <fct>                 <dbl>          <dbl>          <dbl>\n#> 1 Control              0.0417         0.0260         0.0668\n#> 2 FSHD                 1.74           0.0856         6.05#> \n#> Call:\n#> glm(formula = rfM6_fit ~ Fat_Infilt_Percent + STIR_status, family = \"binomial\", \n#>     data = data)\n#> \n#> Deviance Residuals: \n#>      Min        1Q    Median        3Q       Max  \n#> -2.18405   0.04185   0.51973   0.81414   0.96049  \n#> \n#> Coefficients:\n#>                    Estimate Std. Error z value Pr(>|z|)\n#> (Intercept)          0.1377     0.7357   0.187    0.852\n#> Fat_Infilt_Percent   8.3965     7.5969   1.105    0.269\n#> STIR_statusSTIR+     0.7714     1.2636   0.610    0.542\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 59.598  on 58  degrees of freedom\n#> Residual deviance: 51.047  on 56  degrees of freedom\n#> AIC: 57.047\n#> \n#> Number of Fisher Scoring iterations: 7"},{"path":"MRI-vs-DUX4-score.html","id":"scheme-2-binary-outcome-using-dux4-score-0.5","chapter":"5 MRI characteristics and DUX4 molecular signatures","heading":"5.2.2 Scheme 2: Binary outcome using DUX4 score > 0.5","text":"use DUX4 score defined accumulated log(TPM+1) six genes DUX4 basket. use whole muscle fat percent STIR status predictor infer occurrence DUX4 score > 0.5. reason chose 0.5 threshold TPM=0.2 conventional threshold call whether gene expressed sum six genes expressed level approximately 0.5: \\(\\sum_1^6 log_{10}(0.2 + 1) \\approx 0.5\\).NOTE: Predictions 13-0007R 13-0009R excluded.\n(#tab:scheme2_based_on_DUX4_score)Number STIR- STIR+ DUX4 < 0.5 DUX4 >=0.5 group.\ncase, general linear model depicted STIR status key association DUX4 signatures whereas fat infiltration fraction presented less solid evident direct association (p-value=0.3). Summary logistic regression statistics:\nFigure 5.2: Logistic prediction model occurrence DUX4 score >=0.5. Grey dashed line presents prediction using soley fat percent predictor.\n","code":"#> \n#> Call:\n#> glm(formula = `DUX4-M6-logSum-positive` ~ Fat_Infilt_Percent + \n#>     STIR_status, family = \"binomial\", data = data)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -2.1838  -0.7054  -0.5871   0.3009   1.8516  \n#> \n#> Coefficients:\n#>                    Estimate Std. Error z value Pr(>|z|)  \n#> (Intercept)         -1.9431     0.7751  -2.507   0.0122 *\n#> Fat_Infilt_Percent   7.8039     7.2899   1.071   0.2844  \n#> STIR_statusSTIR+     2.9489     1.2501   2.359   0.0183 *\n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 85.886  on 61  degrees of freedom\n#> Residual deviance: 48.859  on 59  degrees of freedom\n#> AIC: 54.859\n#> \n#> Number of Fisher Scoring iterations: 7"},{"path":"MRI-vs-DUX4-score.html","id":"use-logistic-regression-to-predict-the-moderate-occurrence","chapter":"5 MRI characteristics and DUX4 molecular signatures","heading":"5.2.3 Use logistic regression to predict the Moderate+ occurrence","text":"outcome Moderate+ occurrence predicted random forest built upon 30 basket genes distinguishing control moderate+IG-high+high FSHDs.\nFigure 5.3: Logistic prediction occurrance Moderate+.\n\nFigure 5.4: Logistic repression three different classification shemes\n","code":"#> # A tibble: 3 × 4\n#>   class        avg_DUX4_score min_DUX4_score max_DUX4_score\n#>   <fct>                 <dbl>          <dbl>          <dbl>\n#> 1 Control-like          0.163         0.0260          0.709\n#> 2 Moderate+             1.78          0.0266          6.05 \n#> 3 Muscle-Low            0.438         0.365           0.510#> \n#> Call:\n#> glm(formula = randomForest.fit ~ Fat_Infilt_Percent + STIR_status, \n#>     family = \"binomial\", data = data)\n#> \n#> Deviance Residuals: \n#>     Min       1Q   Median       3Q      Max  \n#> -1.8231  -1.2550   0.4110   0.9434   1.1812  \n#> \n#> Coefficients:\n#>                    Estimate Std. Error z value Pr(>|z|)\n#> (Intercept)         -0.3331     0.6417  -0.519    0.604\n#> Fat_Infilt_Percent   9.6883     6.4148   1.510    0.131\n#> STIR_statusSTIR+     0.1928     1.0038   0.192    0.848\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 72.836  on 61  degrees of freedom\n#> Residual deviance: 61.901  on 59  degrees of freedom\n#>   (2 observations deleted due to missingness)\n#> AIC: 67.901\n#> \n#> Number of Fisher Scoring iterations: 7"},{"path":"DUX4-basket.html","id":"DUX4-basket","chapter":"6 DUX4 basket","heading":"6 DUX4 basket","text":"Update coming soon","code":""},{"path":"other-baskets.html","id":"other-baskets","chapter":"7 Inflammatory, ECM, complement activation and immunoglobulins signatures","heading":"7 Inflammatory, ECM, complement activation and immunoglobulins signatures","text":"Update soon.","code":""},{"path":"bilateral-comparison.html","id":"bilateral-comparison","chapter":"8 Bilateral comparison","heading":"8 Bilateral comparison","text":"","code":""},{"path":"bilateral-comparison.html","id":"random-pairing-simulation-to-show-symmetric-trends-on-mri-characteristics","chapter":"8 Bilateral comparison","heading":"8.1 Random pairing simulation to show symmetric trends on MRI characteristics","text":"34 subjects, ten rated STIR+ TAs, 19 STIR- bilaterally, five discordant STIR. question , given 43- STIR 25 STIR+ form 34 pairs, expected values STIR+, STIR- discordant STIR-/STIR+ pairs? observed values different expected values?answer question, performed 1000 runs simulation, run, 34 pairs randomly drowned 43 STIR- 25 STIR+ samples, yielding numbers STIR+, STIR-, discordance STIR+/- pairs. simulation built three distributions number three types pairs, expected values pair type 4.5 pairs STIR+, 13.5 STIR- 16 STIR+/-. observed values STIR+ (10) STIR- (19) pairs reveal symmetric trends STIR characteristics.","code":"\n# simulation distribution of the STIR+/+ (1,1), STIR-/- (0,0), and STIR-/+ (0,1) paire # 0 = STIR-\n# 1 = STIR+\nn_simulation <- 10000\nsim_list <- vector(\"list\", n_simulation)\nfor (j in 1:n_simulation) {\n  n_pos <- 25 # 1: STIR+\n  n_neg <- 43 # 0: STIR-\n  n_pairs <- (n_pos + n_neg) / 2\n\n  set.seed <- j\n \n  res <- vector(\"integer\", n_pairs)\n  for (i in 1:n_pairs) {\n    stir <- c(rep(1, n_pos), rep(0, n_neg))\n    res[i] <- sum(sample(x=stir, 2, replace=FALSE))\n    n_pos <- n_pos - res[i]\n    n_neg <- n_neg - (2-res[i])\n  }\n\n  sim_list[[j]] <- table(res)\n}\n\nsim_res <- do.call(rbind, sim_list) %>%\n  as.data.frame() %>%\n  rename(`STIR-/-`= `0`, `STIR+/-`=`1`, `STIR+/+`=`2`) %>%\n  gather(key=\"pairs\", value=\"n\")annot <- sim_res %>% group_by(pairs) %>%\n  summarise(mu = mean(n)) %>%\n  dplyr::mutate(x_mu = mu, y_mu = 0) %>%\n  dplyr::mutate(x_n=c(19, 5, 10), y_n=0) %>%\n  dplyr::mutate(mu_label = format(mu, digit=2))\n\nggplot(sim_res, aes(x=n)) +\n   geom_density(adjust=3.5, n=256) +\n   #geom_histogram(bins=10) +\n   facet_wrap( ~ pairs, nrow=3) +\n   geom_point(data=annot, aes(x=x_n, y=y_n), \n              size=2, color=\"red\", shape=4) +\n   geom_text(data=annot, aes(x=x_mu, y=y_mu, \n                             label=paste0(\"mu = \", mu_label)), \n             hjust=0, vjust=0, color=\"gray50\") +\n   geom_vline(data=annot, aes(xintercept=mu),\n              linetype=\"dashed\", color=\"gray50\") +\n   labs(x=\"number of pairs\", y=\"density\") +\n   theme_bw()\nggsave(file.path(pkg_dir, \"figures\", \"STIR-2000-simulation-pairs.pdf\"), \n       width=4, height=4)   \n}"},{"path":"bilateral-comparison.html","id":"fat-infiltration","chapter":"8 Bilateral comparison","heading":"8.2 Fat infiltration","text":"Pearson correlation right left fat infiltration 0.82.\nFigure 8.1: Left right whole muscle fat percent.\n","code":"#> # A tibble: 1 × 1\n#>     cor\n#>   <dbl>\n#> 1 0.821"},{"path":"bilateral-comparison.html","id":"muscle-strength","chapter":"8 Bilateral comparison","heading":"8.3 Muscle strength","text":"\nFigure 8.2: Left right TA muscle strength (foot dorsiflexors).\n","code":""},{"path":"bilateral-comparison.html","id":"histopathological-variables","chapter":"8 Bilateral comparison","heading":"8.4 Histopathological variables","text":"\nFigure 8.3: Lift right TA muscle histopathological variables.\n","code":""},{"path":"bilateral-comparison.html","id":"fshd-signatures-bilateral-comparisons","chapter":"8 Bilateral comparison","heading":"8.5 FSHD-signatures bilateral comparisons","text":"","code":""},{"path":"bilateral-comparison.html","id":"per-gene-correlation","chapter":"8 Bilateral comparison","heading":"8.5.1 Per-gene correlation","text":"calculated left-t-right correlation every genes baskets. expression level used TPM.\nTable 8.1: Mean correlation genes baskets calculated TPM L/R muscle.\nScatter plot genes\n6 5 scatter plots\n","code":""},{"path":"bilateral-comparison.html","id":"per-basket-by-log-sum","chapter":"8 Bilateral comparison","heading":"8.5.2 Per-basket by log sum","text":"calculate per-basket bilateral correlation using basket scores (accumulated \\(log_{10}(TPM+1)\\)).\nFigure 8.4: Basket score feft Right TA muscles.\n","code":""},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"","code":""}]
